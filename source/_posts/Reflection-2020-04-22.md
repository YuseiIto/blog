---
layout: post
title: Reflection 2020/04/22
date: 2020-04-23 00:37:14
tags: ["reflection", "AWS", "数学", "API Gateway", "Lambda", "進路", "CORS"]
---

## 8:43 起床

慌てて起きた。あしたこそちゃんと起きよう。
アラームの複数セットがやばいのではと思ったので、明日は一つにしてそれで起きるようにする。

## 9:30 朝の諸々完了

ごはんとか、歯磨きとか。
この Reflection を書き始めた日(HackMD に書いてた頃)の初日から、朝ごはん食べて作業する前に歯を磨くことにした。
切り替わるのでかなりよい。

しばらく、「今日なにやろかなー」って考えてた。

## 10:00- 昨日のことが気になって、進路モノの話を片付ける

昨日深く考えすぎたのもあって、その思考の続きが気になった。
引き続きいろいろな情報を漁る。
どうやら僕は、imagine the future する可能性が結構あるのかもしれない。
というか、立命以外行くなら多分そこだ。
というわけで、imagine the future してる各位、特に AC 各位は色々教えてください。

## 12:00- 数学

数列の極限。
難しくはないが、計算でミスると全てがコケるので辛い。

- 有理化
- 分数関数を分解する
- 因数分解

あたりで大体の問題はきれいにいけるんだなと思った。
今日も解答はちゃんと書いた。

## 13:00 昼ごはん

ホルモン焼きそば。
おいしいね。

## 13:30- zoom でもくもく

いつもの人が付き合ってくれた。ありがとうな、いつもの人。

この間で、体育のしょうもないレポートをやった。
つまらん。
私の、数少ない「面白がれないこと」のうちの一つだ。退屈なレポート。

## 16:00 おべんつよ終わり。

コードを書き始めた。
何件かコーディングな案件を抱えている。

## 覚えてない

多分こういう時間でかなり無駄してたんだと思う

## 18:00 　コーディングはじめる

API Gateway の CORS 設定に困りはじめる。
そもそも backend がある Web app を自分でちゃんと作ったのが 2019 年 1 月に作ったもの以来だったので、CORS 系のヘッダを思い出すところからスタート。
さらに AWS のコンソールの使い方がわからんくて詰む。

## 19:30 めし

### 20:15- コーディング

しばらく色々困ってた。
その後、ツイッタァで泣いてたら、ぶんぶん大先生がおしえてくれることになった。
彼、AWS と Web の仕様にはずば抜けて強いと思う。
でも、僕が使っていたリージョンが `us-east-1`　で、 `ap-northeast-1`(tokyo)とコンソールの表示が違っていたので、二人して微妙にわからん感じになった。

で、CloudWatch の設定の仕方含めて教えていただきながら、CORS エラーの原因探し。
CORS だと思ってたら API Gateway の方にはなんのエラーも出てなくて、lambda の方で HHTP`500`が出てた。なんじゃそれ。
ちなみにその原因は undefined な変数があったこと。
CORS ちゃうやん...

lambda の`event`オブジェクト(`handler`の第一引数)は、body をオブジェクトでなく string で持ってくるので、`JSON.parse`しないといけなかったのと、if 文の中で　`const`　で変数定義してるところがあって、それが if 文を出るとスコープ外だから使えないとか、そういうことだった。

で、それを直してもなおエラー。
なんでだろうと思って`event` オブジェクトを cloud watch に吐いてみたら、`httpmethod:OPTIONS`になっていた。
preflight リクエストが lambda に飛んできてるっぽい...?

というわけで、API gateway の console からその統合の設定をして、リクエストタイプを`ANY`から `POST`にしたらうまくいった。

まじで CORS じゃないのに CORS って言うのやめろ。

で、この後さくっと機能実装して風呂、ぶどうジュース、歯磨き。

## Overall

今日は、全体としてだらだらしてしまった。反省している。
主な原因は、朝の起床が遅れたこと、気になったことをすぐに goog りはじめてしまったこと、いろんな物事を中途半端に止めてしまっていたことだと思う。
3 つめに関しては一定仕方ないが、Trello とか使って進捗が見えるようにしておけば、脳内からそう言うの抜いて作業できるかなとか思った。
前半二つについては、明日以降の意識で改善したい。

特に、作業中気になったことはとりあえず壁のホワイトボードに書いておいて、後からそれのための時間を作って集中してやった方が、色々効率もいいはず。

さてと、最近、メディアがメディアを呼ぶ展開となっている。
周りのコロナサイト系高校生も同じ感じらしい。
おそらく、明日以降もう一件取材を受ける。
お受けしようかどうするか、悩んでいた件だが、C4K のみなさんの助言を受けて、お受けしようということに決めた。
さてと、明日はもう少し時間を有効に使えるといいな。今日はあまり満足感が高くない。
